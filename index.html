<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>OrbitSmith â€” Space Debris Tracker</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&family=IBM+Plex+Mono:wght@300;400;500&family=Noto+Sans+JP:wght@300;400;500&family=Noto+Sans+SC:wght@300;400;500&display=swap');

  *{margin:0;padding:0;box-sizing:border-box;}
  body{background:#000;color:#d0d4dc;font-family:'IBM Plex Mono','Noto Sans JP','Noto Sans SC',monospace;overflow:hidden;height:100vh;width:100vw;user-select:none;font-size:12px;}
  #canvas-container{position:fixed;top:0;left:0;width:100%;height:100%;z-index:1;}

  .top-bar{position:fixed;top:0;left:0;right:0;height:52px;display:flex;align-items:center;justify-content:space-between;padding:0 24px;z-index:100;background:rgba(0,0,0,0.94);border-bottom:1px solid rgba(255,255,255,0.04);}
  .logo{display:flex;align-items:center;gap:10px;}
  .logo-icon{width:28px;height:28px;}
  .logo-text{font-family:'Orbitron',sans-serif;font-weight:700;font-size:14px;letter-spacing:3px;color:#fff;}
  .logo-text span{color:#00e5ff;}
  .top-right{display:flex;align-items:center;gap:16px;}

  .lang-selector{position:relative;}
  .lang-current{display:flex;align-items:center;gap:5px;padding:4px 10px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.08);border-radius:5px;font-size:10px;letter-spacing:1px;color:rgba(255,255,255,0.6);cursor:pointer;transition:all 0.2s;}
  .lang-current:hover{border-color:rgba(255,255,255,0.15);}
  .lang-current::after{content:'â–¾';font-size:8px;margin-left:2px;}
  .lang-dropdown{position:absolute;top:calc(100% + 4px);right:0;background:rgba(10,14,22,0.97);border:1px solid rgba(255,255,255,0.1);border-radius:6px;overflow:hidden;display:none;min-width:120px;backdrop-filter:blur(12px);z-index:200;}
  .lang-dropdown.open{display:block;}
  .lang-option{padding:7px 14px;font-size:11px;color:rgba(255,255,255,0.5);cursor:pointer;transition:all 0.15s;}
  .lang-option:hover{background:rgba(0,229,255,0.08);color:#00e5ff;}
  .lang-option.active{color:#00e5ff;}

  .top-status{display:flex;align-items:center;gap:20px;font-size:10px;letter-spacing:1px;text-transform:uppercase;color:rgba(255,255,255,0.45);}
  .status-dot{display:inline-block;width:5px;height:5px;background:#00e5ff;border-radius:50%;margin-right:5px;animation:pulse-dot 2s ease-in-out infinite;}
  @keyframes pulse-dot{0%,100%{opacity:1;}50%{opacity:0.3;}}
  .time-display{font-family:'Orbitron',sans-serif;font-size:10px;color:rgba(255,255,255,0.5);letter-spacing:2px;}

  .side-panel{position:fixed;top:66px;left:20px;width:270px;z-index:100;display:flex;flex-direction:column;gap:10px;max-height:calc(100vh - 120px);overflow-y:auto;scrollbar-width:none;}
  .side-panel::-webkit-scrollbar{display:none;}
  .right-panel{position:fixed;top:66px;right:20px;width:270px;z-index:100;display:flex;flex-direction:column;gap:10px;max-height:calc(100vh - 120px);overflow-y:auto;scrollbar-width:none;}
  .right-panel::-webkit-scrollbar{display:none;}

  .panel-card{background:rgba(6,10,18,0.9);backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,0.05);border-radius:10px;padding:16px 18px;transition:border-color 0.3s;}
  .panel-card:hover{border-color:rgba(0,229,255,0.1);}
  .panel-label{font-size:9px;letter-spacing:2px;text-transform:uppercase;color:rgba(255,255,255,0.3);margin-bottom:6px;position:relative;}
  .panel-value{font-family:'Orbitron',sans-serif;font-size:26px;font-weight:700;line-height:1;}
  .panel-value.cyan{color:#00e5ff;}.panel-value.amber{color:#ffab00;}.panel-value.red{color:#ff3d5a;}
  .panel-sub{font-size:10px;color:rgba(255,255,255,0.35);margin-top:5px;}
  .legend{display:flex;flex-direction:column;gap:8px;}
  .legend-item{display:flex;align-items:center;gap:8px;font-size:10px;}
  .legend-dot{width:8px;height:8px;border-radius:50%;flex-shrink:0;}
  .legend-count{margin-left:auto;font-family:'Orbitron',sans-serif;font-size:11px;font-weight:500;color:#fff;}

  /* Tooltips */
  .has-tip{position:relative;cursor:help;border-bottom:1px dotted rgba(255,255,255,0.15);}
  .tip-trigger{display:inline-block;width:14px;height:14px;border-radius:50%;background:rgba(255,255,255,0.06);border:1px solid rgba(255,255,255,0.12);color:rgba(255,255,255,0.4);font-size:9px;text-align:center;line-height:13px;cursor:help;margin-left:5px;vertical-align:middle;font-style:normal;font-family:'IBM Plex Mono',monospace;}
  .tip-trigger:hover{background:rgba(0,229,255,0.1);border-color:rgba(0,229,255,0.3);color:#00e5ff;}
  .tip-box{display:none;}
  #global-tip{position:fixed;background:rgba(8,14,26,0.97);border:1px solid rgba(0,229,255,0.25);border-radius:8px;padding:10px 14px;font-size:11px;font-weight:400;color:rgba(255,255,255,0.8);line-height:1.65;width:260px;pointer-events:none;opacity:0;transition:opacity 0.15s;z-index:9000;backdrop-filter:blur(14px);letter-spacing:0;text-transform:none;font-family:'IBM Plex Mono',sans-serif;}

  .kessler-tabs{display:flex;gap:2px;margin:8px 0;background:rgba(255,255,255,0.03);border-radius:4px;padding:2px;}
  .kessler-tab{flex:1;padding:4px 0;text-align:center;font-size:9px;letter-spacing:1px;color:rgba(255,255,255,0.3);cursor:pointer;border-radius:3px;transition:all 0.2s;}
  .kessler-tab:hover{color:rgba(255,255,255,0.5);}
  .kessler-tab.active{background:rgba(0,229,255,0.1);color:#00e5ff;}
  .risk-bar-container{height:4px;background:rgba(255,255,255,0.06);border-radius:2px;margin-top:8px;overflow:hidden;}
  .risk-bar{height:100%;border-radius:2px;background:linear-gradient(90deg,#00e5ff,#ffab00,#ff3d5a);transition:width 0.6s ease;}

  /* Horizontal scroll alerts - auto ticker */
  .alerts-container{position:fixed;bottom:48px;left:310px;right:310px;z-index:100;overflow:hidden;white-space:nowrap;padding:6px 0;}
  .alerts-track{display:inline-block;white-space:nowrap;animation:ticker-scroll 60s linear infinite;}
  .alerts-container:hover .alerts-track{animation-play-state:paused;}
  @keyframes ticker-scroll{0%{transform:translateX(0);}100%{transform:translateX(-50%);}}
  .alert-card{display:inline-block;background:rgba(255,61,90,0.08);border:1px solid rgba(255,61,90,0.2);backdrop-filter:blur(10px);border-radius:8px;padding:8px 16px;font-size:10px;color:#ff6b82;white-space:nowrap;margin-right:8px;vertical-align:top;}
  
  .alert-card{display:inline-block;background:rgba(255,61,90,0.08);border:1px solid rgba(255,61,90,0.2);backdrop-filter:blur(10px);border-radius:8px;padding:8px 16px;font-size:10px;color:#ff6b82;white-space:nowrap;margin-right:8px;vertical-align:top;}
  .alert-card strong{color:#ff3d5a;}

  .frag-item{padding:8px 0;border-bottom:1px solid rgba(255,255,255,0.04);}
  .frag-item:last-child{border-bottom:none;}
  .frag-event{font-size:11px;color:rgba(255,255,255,0.7);margin-bottom:3px;}
  .frag-detail{font-size:10px;color:rgba(255,255,255,0.35);line-height:1.5;}

  .calc-panel{background:rgba(6,10,18,0.94);border:1px solid rgba(0,229,255,0.1);border-radius:10px;padding:16px 18px;}
  .calc-panel .panel-label{color:#00e5ff;margin-bottom:10px;}
  .calc-row{display:flex;flex-direction:column;gap:3px;margin-bottom:10px;}
  .calc-field-label{font-size:8px;letter-spacing:1.5px;text-transform:uppercase;color:rgba(255,255,255,0.25);}
  .calc-input,.calc-select{width:100%;padding:7px 9px;background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:5px;color:#d0d4dc;font-family:'IBM Plex Mono',monospace;font-size:11px;outline:none;transition:border-color 0.2s;}
  .calc-input:focus,.calc-select:focus{border-color:rgba(0,229,255,0.25);}
  .calc-select option{background:#0a0e18;color:#d0d4dc;}
  .calc-autocomplete{position:absolute;top:100%;left:0;right:0;background:rgba(10,16,28,0.97);border:1px solid rgba(255,255,255,0.1);border-radius:0 0 5px 5px;max-height:150px;overflow-y:auto;z-index:250;display:none;}
  .calc-autocomplete.open{display:block;}
  .ac-item{padding:6px 10px;font-size:10px;color:rgba(255,255,255,0.6);cursor:pointer;transition:background 0.15s;}
  .ac-item:hover{background:rgba(0,229,255,0.08);color:#00e5ff;}
  .ac-item .ac-id{color:rgba(255,255,255,0.3);margin-right:6px;}
  .calc-input-wrap{position:relative;}
  .calc-btn{width:100%;padding:8px;background:rgba(0,229,255,0.08);border:1px solid rgba(0,229,255,0.2);border-radius:5px;color:#00e5ff;font-family:'IBM Plex Mono',monospace;font-size:10px;letter-spacing:1.5px;text-transform:uppercase;cursor:pointer;transition:all 0.2s;margin-top:2px;}
  .calc-btn:hover{background:rgba(0,229,255,0.15);}
  .calc-result{margin-top:12px;padding-top:12px;border-top:1px solid rgba(255,255,255,0.05);display:none;}
  .calc-result.show{display:block;}
  .result-row{display:flex;justify-content:space-between;align-items:baseline;margin-bottom:6px;}
  .result-label{font-size:9px;color:rgba(255,255,255,0.35);}
  .result-value{font-family:'Orbitron',sans-serif;font-size:12px;font-weight:500;color:#fff;}
  .result-prob{font-family:'Orbitron',sans-serif;font-size:20px;font-weight:700;text-align:center;margin:10px 0 4px;}
  .result-risk-label{text-align:center;font-size:9px;letter-spacing:2px;text-transform:uppercase;}

  .calc-method{margin-top:10px;padding:8px 10px;background:rgba(255,255,255,0.02);border:1px solid rgba(255,255,255,0.05);border-radius:5px;font-size:9px;color:rgba(255,255,255,0.3);line-height:1.6;}
  .calc-method summary{cursor:pointer;color:rgba(255,255,255,0.4);font-size:9px;letter-spacing:0.5px;}
  .calc-method summary:hover{color:rgba(255,255,255,0.6);}

  .pro-badge{display:inline-block;padding:10px 12px;background:rgba(255,171,0,0.05);border:1px solid rgba(255,171,0,0.12);border-radius:6px;font-size:9px;color:rgba(255,171,0,0.55);text-align:center;margin-top:10px;width:100%;line-height:1.6;}

  .bottom-bar{position:fixed;bottom:0;left:0;right:0;height:44px;display:flex;align-items:center;justify-content:center;gap:5px;z-index:100;background:rgba(0,0,0,0.92);padding:0 16px;}
  .disclaimer{position:fixed;bottom:48px;left:20px;z-index:101;font-size:8px;color:rgba(255,255,255,0.4);max-width:290px;line-height:1.4;letter-spacing:0.2px;}
  .filter-btn{font-family:'IBM Plex Mono','Noto Sans JP',monospace;font-size:9px;letter-spacing:1px;text-transform:uppercase;color:rgba(255,255,255,0.25);background:rgba(255,255,255,0.02);border:1px solid rgba(255,255,255,0.06);border-radius:5px;padding:6px 12px;cursor:pointer;transition:all 0.2s;}
  .filter-btn:hover{color:rgba(255,255,255,0.5);border-color:rgba(255,255,255,0.12);}
  .filter-btn.active{color:#00e5ff;border-color:rgba(0,229,255,0.3);background:rgba(0,229,255,0.08);}


  .loading-screen{position:fixed;inset:0;background:#000;z-index:9999;display:flex;flex-direction:column;align-items:center;justify-content:center;transition:opacity 1s ease;}
  .loading-screen.fade-out{opacity:0;pointer-events:none;}
  .loading-text{font-family:'Orbitron',sans-serif;font-size:13px;letter-spacing:5px;color:rgba(0,229,255,0.6);margin-top:24px;}
  .loading-ring{width:50px;height:50px;border:2px solid rgba(0,229,255,0.1);border-top-color:#00e5ff;border-radius:50%;animation:spin 1s linear infinite;}
  @keyframes spin{to{transform:rotate(360deg);}}

  .nav-link{font-family:'IBM Plex Mono','Noto Sans JP',monospace;font-size:9px;letter-spacing:2px;text-transform:uppercase;color:rgba(255,255,255,0.45);text-decoration:none;padding:4px 8px;border:1px solid rgba(255,255,255,0.08);border-radius:4px;transition:all 0.2s;}
  .nav-link:hover{color:#00e5ff;border-color:rgba(0,229,255,0.3);}
  .nav-link.active{color:#00e5ff;border-color:rgba(0,229,255,0.25);}

  /* MOBILE RESPONSIVE */
  @media(max-width:900px){
    #canvas-container{position:relative!important;width:100%;height:50vh;min-height:300px;}
    .side-panel{position:relative;top:auto;left:auto;width:100%;max-height:none;padding:8px 12px;gap:8px;}
    .right-panel{position:relative;top:auto;right:auto;width:100%;max-height:none;padding:8px 12px;gap:8px;}
    .top-bar{padding:0 12px;z-index:200;}
    .logo-text{font-size:12px;letter-spacing:2px;}
    .top-status .time-display{font-size:9px;}
    .bottom-bar{position:relative;flex-wrap:wrap;height:auto;padding:8px 12px;gap:4px;}
    .filter-btn{font-size:7px;padding:4px 6px;}
    .alerts-container{position:relative;left:auto;right:auto;bottom:auto;padding:6px 12px;}
    .disclaimer{position:relative;bottom:auto;left:auto;max-width:100%;padding:8px 12px;}
    body{overflow-y:auto;padding-top:52px;}
  }
  @media(max-width:600px){
    .top-bar{height:44px;padding:0 10px;}
    .nav-link{font-size:7px;padding:3px 5px;letter-spacing:1px;}
    .top-right{gap:6px;}
    .lang-current{font-size:8px;padding:3px 5px;}
    .top-status{display:none;}
    .side-panel,.right-panel{padding:6px 10px;}
    .panel-card{padding:10px 12px;}
    .panel-value{font-size:22px;}
    .panel-label span:first-child{font-size:8px;}
    .panel-sub{font-size:8px;}
    #canvas-container{height:40vh;min-height:250px;}
    .calc-panel input,.calc-panel select{font-size:11px;padding:6px 8px;}
    .filter-btn{font-size:6.5px;padding:3px 5px;}
    .ticker-track{font-size:9px;}
    body{padding-top:44px;}
  }

</style>
</head>
<body>

<div class="loading-screen" id="loading">
  <div class="loading-ring"></div>
  <div class="loading-text" data-i18n="loading">INITIALIZING ORBITAL DATA</div>
</div>
<div id="canvas-container"></div>

<!-- TOP BAR -->
<div class="top-bar">
  <div class="logo"><svg class="logo-icon" width="28" height="28" viewBox="0 0 512 512" fill="none"><circle cx="256" cy="256" r="120" stroke="#00e5ff" stroke-width="12" fill="none"/><ellipse cx="256" cy="256" rx="160" ry="56" transform="rotate(-30 256 256)" stroke="rgba(0,229,255,0.6)" stroke-width="14" fill="none"/><circle cx="256" cy="256" r="32" fill="#00e5ff"/></svg><div class="logo-text">ORBIT<span>SMITH</span></div></div>
  <div class="top-right">
    <a href="index.html" class="nav-link active">TRACKER</a>
    <a href="about.html" class="nav-link">ABOUT</a>
    <a href="contact.html" class="nav-link">CONTACT</a>
    <div class="lang-selector">
      <div class="lang-current" id="lang-current">EN</div>
      <div class="lang-dropdown" id="lang-dropdown">
        <div class="lang-option active" data-lang="en">ğŸ‡ºğŸ‡¸ English</div>
        <div class="lang-option" data-lang="ja">ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª</div>
        <div class="lang-option" data-lang="zh">ğŸ‡¨ğŸ‡³ ä¸­æ–‡</div>
        <div class="lang-option" data-lang="es">ğŸ‡ªğŸ‡¸ EspaÃ±ol</div>
      </div>
    </div>
    <div class="top-status">
      <div class="time-display" id="utc-time"></div>
      <div><span class="status-dot"></span><span data-i18n="liveTracking">LIVE TRACKING</span></div>
    </div>
  </div>
</div>

<!-- LEFT PANEL -->
<div class="side-panel">
  <div class="panel-card">
    <div class="panel-label">
      <span data-i18n="trackedObjects">Tracked Objects</span>
      <span class="tip-trigger">?</span>
      <div class="tip-box" data-i18n="tipTracked">Total number of cataloged objects currently being tracked in Earth orbit, including active satellites, defunct satellites, rocket bodies, and debris fragments.</div>
    </div>
    <div class="panel-value cyan" id="total-count">0</div>
    <div class="panel-sub">
      <span data-i18n="trackedSub">Updated in real-time from </span>
      <span class="has-tip" style="border-bottom:1px dotted rgba(255,255,255,0.2)">TLE
        <div class="tip-box" data-i18n="tipTLE">TLE (Two-Line Element set) is a standardized data format used to describe the orbit of an Earth-orbiting object. Published by the US Space Command, TLEs enable prediction of an object's position at any given time.</div>
      </span>
      <span data-i18n="trackedSub2"> data</span>
    </div>
  </div>
  <div class="panel-card">
    <div class="panel-label">
      <span data-i18n="activeConj">Active Conjunctions (24h)</span>
      <span class="tip-trigger">?</span>
      <div class="tip-box" data-i18n="tipConj">A conjunction occurs when two objects in orbit pass close to each other (within 1km). These events are monitored continuously to assess collision risk and determine if avoidance maneuvers are needed.</div>
    </div>
    <div class="panel-value amber" id="conjunction-count">0</div>
    <div class="panel-sub" data-i18n="conjSub">Predicted close approaches &lt; 1km</div>
  </div>
  <div class="panel-card">
    <div class="panel-label">
      <span data-i18n="fragEvents">Fragmentation Events (30d)</span>
      <span class="tip-trigger">?</span>
      <div class="tip-box" data-i18n="tipFrag">A fragmentation event occurs when a space object breaks apart â€” from collisions, explosions, battery failures, or material degradation â€” creating multiple new trackable debris pieces.</div>
    </div>
    <div class="panel-value red">3</div>
    <div class="frag-item">
      <div class="frag-event">ğŸ”´ 2026-02-18 â€” SL-16 R/B breakup</div>
      <div class="frag-detail" data-i18n="frag1">Proton upper stage (1993-015B) spontaneous breakup at 850km due to residual propellant. +23 fragments cataloged.</div>
    </div>
    <div class="frag-item">
      <div class="frag-event">ğŸŸ  2026-02-09 â€” CZ-3B R/B debris shed</div>
      <div class="frag-detail" data-i18n="frag2">Long March 3B upper stage (2019-074B) thermal cycling stress fragmentation at 780km. +15 fragments.</div>
    </div>
    <div class="frag-item">
      <div class="frag-event">ğŸŸ¡ 2026-01-28 â€” Unknown breakup</div>
      <div class="frag-detail" data-i18n="frag3">Unidentified object near 920km / 99Â° inc. Possible micrometeorite impact. +9 fragments detected by 18th SDS.</div>
    </div>
  </div>
  <div class="panel-card">
    <div class="panel-label" data-i18n="orbitDist">Orbit Distribution</div>
    <div class="legend">
      <div class="legend-item"><div class="legend-dot" style="background:#00b8d4"></div><span style="color:rgba(255,255,255,0.55)" data-i18n="leo">LEO (200â€“2,000 km)</span><span class="legend-count" id="leo-count">0</span></div>
      <div class="legend-item"><div class="legend-dot" style="background:#d4a000"></div><span style="color:rgba(255,255,255,0.55)" data-i18n="meo">MEO (2,000â€“35,786 km)</span><span class="legend-count" id="meo-count">0</span></div>
      <div class="legend-item"><div class="legend-dot" style="background:#8868c8"></div><span style="color:rgba(255,255,255,0.55)" data-i18n="geo">GEO (~35,786 km)</span><span class="legend-count" id="geo-count">0</span></div>
      <div class="legend-item"><div class="legend-dot" style="background:#c83850"></div><span style="color:rgba(255,255,255,0.55)" data-i18n="heo">HEO / Other</span><span class="legend-count" id="heo-count">0</span></div>
    </div>
  </div>
</div>

<!-- RIGHT PANEL -->
<div class="right-panel">
  <div class="panel-card">
    <div class="panel-label">
      <span data-i18n="kesslerRisk">Kessler Risk Index</span>
      <span class="tip-trigger">?</span>
      <div class="tip-box" data-i18n="tipKessler">The Kessler Syndrome describes a cascading chain reaction where collisions create debris that causes further collisions. This index estimates the current risk level for each orbital regime based on object density and relative velocities.</div>
    </div>
    <div class="kessler-tabs">
      <div class="kessler-tab active" data-orbit="leo">LEO</div>
      <div class="kessler-tab" data-orbit="meo">MEO</div>
      <div class="kessler-tab" data-orbit="geo">GEO</div>
      <div class="kessler-tab" data-orbit="heo">HEO</div>
    </div>
    <div class="panel-value" style="font-size:20px" id="kessler-level">MODERATE</div>
    <div class="risk-bar-container"><div class="risk-bar" id="kessler-bar" style="width:58%"></div></div>
    <div class="panel-sub" style="margin-top:6px" id="kessler-detail" data-i18n="kesslerSub">LEO 800â€“1000 km band: highest debris density</div>
  </div>

  <!-- COLLISION CALC -->
  <div class="calc-panel">
    <div class="panel-label">
      <span data-i18n="calcTitle">âš¡ Collision Probability</span>
      <span class="tip-trigger">?</span>
      <div class="tip-box" data-i18n="tipCalc">Estimates the probability that two specific objects will collide within a given time window. Free version includes 50 sample objects; PRO unlocks the full Space-Track catalog (45,000+ objects).</div>
    </div>
    <div class="calc-row">
      <div class="calc-field-label" data-i18n="calcObj1">Object 1 (NORAD ID or name)</div>
      <div class="calc-input-wrap">
        <input class="calc-input" id="calc-obj1" placeholder="e.g. 25544 or ISS" autocomplete="off">
        <div class="calc-autocomplete" id="ac1"></div>
      </div>
    </div>
    <div class="calc-row">
      <div class="calc-field-label" data-i18n="calcObj2">Object 2 (NORAD ID or name)</div>
      <div class="calc-input-wrap">
        <input class="calc-input" id="calc-obj2" placeholder="e.g. 36411 or COSMOS" autocomplete="off">
        <div class="calc-autocomplete" id="ac2"></div>
      </div>
    </div>
    <div class="calc-row">
      <div class="calc-field-label" data-i18n="calcWindow">Time Window</div>
      <select class="calc-select" id="calc-window">
        <option value="24">24 hours</option>
        <option value="72">72 hours</option>
        <option value="168" selected>7 days</option>
        <option value="720">30 days</option>
      </select>
    </div>
    <button class="calc-btn" id="calc-run" data-i18n="calcRun">COMPUTE PROBABILITY</button>
    <div class="calc-result" id="calc-result">
      <div class="result-row"><span class="result-label" data-i18n="calcMissDist">Min. miss distance</span><span class="result-value" id="res-miss">â€”</span></div>
      <div class="result-row"><span class="result-label" data-i18n="calcRelVel">Relative velocity</span><span class="result-value" id="res-vel">â€”</span></div>
      <div class="result-row"><span class="result-label">TCA</span><span class="result-value" id="res-tca">â€”</span></div>
      <div class="result-prob" id="res-prob">â€”</div>
      <div class="result-risk-label" id="res-risk">â€”</div>
    </div>

    <details class="calc-method">
      <summary data-i18n="calcMethodLabel">How is this calculated?</summary>
      <p data-i18n="calcMethodDesc">Uses a simplified Kessler spatial density model: collision probability = 1 âˆ’ exp(âˆ’V_rel Ã— Ïƒ / V_shell Ã— N_orbits), where V_rel is relative velocity from orbital elements, Ïƒ is combined cross-section, and V_shell is the shared orbital shell volume. For production use, PRO version applies SGP4 orbit propagation with Alfano's method using full covariance matrices.</p>
    </details>

    <div class="pro-badge" data-i18n="proBadge">ğŸ”’ PRO â€” COMING SOON<br>Full Space-Track Catalog (45,000+ objects)<br>Monte Carlo Â· Covariance Realism Â· Maneuver Planning</div>
  </div>

  <div class="panel-card">
    <div class="panel-label">
      <span data-i18n="dataSources">Data Sources</span>
      <span class="tip-trigger">?</span>
      <div class="tip-box" data-i18n="tipData">Orbital data comes from publicly available catalogs maintained by the US Space Command via Space-Track.org, ESA's DISCOS database, and conjunction data messages (CDMs) from CSpOC.</div>
    </div>
    <div style="margin-top:5px;font-size:9px;color:rgba(255,255,255,0.3);line-height:1.8">
      Space-Track.org TLE catalog<br>CSpOC conjunction data<br>ESA DISCOS database
    </div>
  </div>
</div>

<!-- HORIZONTAL SCROLL ALERTS -->
<div class="alerts-container" id="alerts-container"></div>

<!-- BOTTOM -->
<div class="bottom-bar">
  <button class="filter-btn active" data-filter="all" data-i18n="filterAll">ALL OBJECTS</button>
  <button class="filter-btn" data-filter="active" data-i18n="filterActive">ACTIVE SATS</button>
  <button class="filter-btn" data-filter="debris" data-i18n="filterDebris">DEBRIS ONLY</button>
  <button class="filter-btn" data-filter="rockets" data-i18n="filterRockets">ROCKET BODIES</button>
  <button class="filter-btn" data-filter="constellations" data-i18n="filterConst">CONSTELLATIONS</button>
</div>


<!-- DISCLAIMER -->
<div id="global-tip"></div>
<div class="disclaimer" data-i18n="disclaimer">âš  For informational and educational purposes only. Orbital data may be inaccurate or outdated. Do not use for operational decisions. OrbitSmith assumes no liability. Â© 2026 OrbitSmith. All rights reserved.</div>

<script>
// ===== SAT DB =====
const SAT_DB={
'25544':{n:'ISS (ZARYA)',alt:420,inc:51.6,sz:109,t:'Station'},'48274':{n:'STARLINK-5271',alt:550,inc:53.0,sz:3.2,t:'Active'},'36411':{n:'COSMOS 2251 DEB',alt:785,inc:74.0,sz:0.15,t:'Debris'},'25730':{n:'FENGYUN 1C DEB',alt:865,inc:99.0,sz:0.10,t:'Debris'},'43013':{n:'TIANGONG (CSS)',alt:390,inc:41.5,sz:67,t:'Station'},'54216':{n:'ONEWEB-0452',alt:1200,inc:87.9,sz:2.0,t:'Active'},'20580':{n:'HST (HUBBLE)',alt:540,inc:28.5,sz:13.2,t:'Active'},'27386':{n:'ENVISAT',alt:770,inc:98.5,sz:26,t:'Inactive'},'37820':{n:'TIANGONG-1 DEB',alt:340,inc:42.8,sz:0.2,t:'Debris'},'39084':{n:'COSMOS 1408 DEB',alt:480,inc:82.6,sz:0.1,t:'Debris'},'25994':{n:'TERRA',alt:705,inc:98.2,sz:6.8,t:'Active'},'27424':{n:'AQUA',alt:705,inc:98.2,sz:6.5,t:'Active'},'33591':{n:'NOAA 19',alt:870,inc:99.2,sz:4.2,t:'Active'},'43226':{n:'STARLINK-24',alt:550,inc:53.0,sz:3.2,t:'Active'},'40697':{n:'JASON-3',alt:1336,inc:66.0,sz:3.5,t:'Active'},'29107':{n:'CLOUDSAT',alt:705,inc:98.2,sz:3.2,t:'Active'},'41866':{n:'ATLAS V R/B',alt:820,inc:63.4,sz:5.4,t:'Rocket'},'28654':{n:'NOAA 18',alt:854,inc:99.0,sz:4.2,t:'Active'},'26536':{n:'CZ-4B R/B',alt:780,inc:98.6,sz:6.0,t:'Rocket'},'22049':{n:'COSMOS 2151',alt:960,inc:83.0,sz:4.0,t:'Inactive'},'13552':{n:'COSMOS 1275 DEB',alt:990,inc:83.0,sz:0.08,t:'Debris'},'28868':{n:'SL-16 R/B',alt:850,inc:71.0,sz:10.7,t:'Rocket'},'40258':{n:'ALOS-2',alt:628,inc:97.9,sz:6.5,t:'Active'},'39634':{n:'GAOFEN-1',alt:645,inc:98.0,sz:3.0,t:'Active'},'44072':{n:'STARLINK-70',alt:550,inc:53.0,sz:3.2,t:'Active'},'46984':{n:'STARLINK-2305',alt:550,inc:53.0,sz:3.2,t:'Active'},'48078':{n:'STARLINK-4718',alt:540,inc:53.2,sz:3.2,t:'Active'},'51063':{n:'ONEWEB-0384',alt:1200,inc:87.9,sz:2.0,t:'Active'},'41765':{n:'SENTINEL-3A',alt:814,inc:98.6,sz:3.7,t:'Active'},'43437':{n:'SENTINEL-3B',alt:814,inc:98.6,sz:3.7,t:'Active'},'28376':{n:'ALOS (DAICHI)',alt:691,inc:98.2,sz:6.0,t:'Inactive'},'37849':{n:'SUOMI NPP',alt:834,inc:98.7,sz:4.6,t:'Active'},'43689':{n:'ICESAT-2',alt:500,inc:92.0,sz:3.0,t:'Active'},'49260':{n:'JAMES WEBB (L2)',alt:1500000,inc:0,sz:22,t:'Active'},'38709':{n:'LANDSAT 8',alt:705,inc:98.2,sz:3.0,t:'Active'},'44874':{n:'CZ-5B R/B',alt:350,inc:41.5,sz:33,t:'Rocket'},'31304':{n:'FENGYUN 1C DEB (A)',alt:880,inc:99.1,sz:0.05,t:'Debris'},'31310':{n:'FENGYUN 1C DEB (B)',alt:840,inc:98.8,sz:0.08,t:'Debris'},'34602':{n:'IRIDIUM 33 DEB',alt:775,inc:86.4,sz:0.12,t:'Debris'},'34603':{n:'IRIDIUM 33 DEB (A)',alt:790,inc:86.2,sz:0.08,t:'Debris'},'33442':{n:'COSMOS 2251 DEB (A)',alt:800,inc:74.1,sz:0.10,t:'Debris'},'33443':{n:'COSMOS 2251 DEB (B)',alt:770,inc:73.8,sz:0.06,t:'Debris'},'39271':{n:'SL-24 DEB',alt:910,inc:62.8,sz:0.15,t:'Debris'},'45026':{n:'BREEZE-M DEB',alt:440,inc:51.6,sz:0.20,t:'Debris'},'24946':{n:'GLOBALSTAR M026',alt:1414,inc:52.0,sz:2.5,t:'Active'},'25338':{n:'NOAA 15',alt:807,inc:98.5,sz:4.2,t:'Active'},'27607':{n:'SL-12 R/B',alt:640,inc:65.0,sz:8.0,t:'Rocket'},'38046':{n:'H-2A R/B',alt:620,inc:98.0,sz:4.0,t:'Rocket'},'42063':{n:'DELTA 4 DEB',alt:750,inc:63.5,sz:0.3,t:'Debris'},'40940':{n:'GALILEO-14',alt:23222,inc:56.0,sz:2.7,t:'Active'}
};

// ===== ALERTS =====
const ALERTS=[
  {o1:'STARLINK-5271',o2:'COSMOS 2251 DEB',m:'127m',t:'2026-02-24T14:32:18Z'},
  {o1:'ISS',o2:'FENGYUN 1C DEB (A)',m:'340m',t:'2026-02-24T18:05:42Z'},
  {o1:'ENVISAT',o2:'SL-16 R/B',m:'89m',t:'2026-02-24T22:17:03Z'},
  {o1:'SENTINEL-3A',o2:'CZ-4B R/B',m:'210m',t:'2026-02-25T03:44:11Z'},
  {o1:'TIANGONG',o2:'BREEZE-M DEB',m:'455m',t:'2026-02-25T08:22:36Z'},
  {o1:'ONEWEB-0452',o2:'COSMOS 1408 DEB',m:'178m',t:'2026-02-25T11:58:19Z'},
  {o1:'TERRA',o2:'IRIDIUM 33 DEB',m:'312m',t:'2026-02-25T16:09:47Z'}
];
const ac=document.getElementById('alerts-container');
const track=document.createElement('div');track.className='alerts-track';
ALERTS.forEach(a=>{
  const d=document.createElement('div');d.className='alert-card';
  d.innerHTML=`<strong>âš  CONJUNCTION</strong> ${a.o1} Ã— ${a.o2} â€” ${a.m} â€” <span style="color:rgba(255,255,255,0.3)">${a.t}</span>`;
  track.appendChild(d);
});
// Duplicate for seamless loop
ALERTS.forEach(a=>{
  const d=document.createElement('div');d.className='alert-card';
  d.innerHTML=`<strong>âš  CONJUNCTION</strong> ${a.o1} Ã— ${a.o2} â€” ${a.m} â€” <span style="color:rgba(255,255,255,0.3)">${a.t}</span>`;
  track.appendChild(d);
});
ac.appendChild(track);

// ===== KESSLER =====
const KESSLER={
  leo:{level:'MODERATE',color:'#ffab00',width:'58%'},
  meo:{level:'LOW',color:'#00e5ff',width:'22%'},
  geo:{level:'LOW-MED',color:'#00e5ff',width:'35%'},
  heo:{level:'VERY LOW',color:'#00e5ff',width:'12%'}
};
const KESSLER_I18N={
  en:{leo:'LEO 800â€“1000 km band: highest debris density',meo:'GPS/GNSS belt: sparse but increasing',geo:'GEO belt: controlled slots, growing debris',heo:'Molniya/Tundra orbits: low density'},
  ja:{leo:'LEO 800â€“1000 kmå¸¯: æœ€ã‚‚ãƒ‡ãƒ–ãƒªå¯†åº¦ãŒé«˜ã„é ˜åŸŸ',meo:'GPS/GNSSå¸¯åŸŸ: ä½å¯†åº¦ã ãŒå¢—åŠ å‚¾å‘',geo:'GEOå¸¯åŸŸ: ç®¡ç†ã‚¹ãƒ­ãƒƒãƒˆã ãŒãƒ‡ãƒ–ãƒªå¢—åŠ ä¸­',heo:'ãƒ¢ãƒ«ãƒ‹ãƒ¤/ãƒ„ãƒ³ãƒ‰ãƒ©è»Œé“: ä½å¯†åº¦'},
  zh:{leo:'LEO 800â€“1000 kmå¸¦: ç¢ç‰‡å¯†åº¦æœ€é«˜åŒºåŸŸ',meo:'GPS/GNSSå¸¦: ç¨€ç–ä½†åœ¨å¢é•¿',geo:'GEOå¸¦: å—æ§ä½†ç¢ç‰‡å¢åŠ ',heo:'è«å°”å°¼äºš/è‹”åŸè½¨é“: ä½å¯†åº¦'},
  es:{leo:'LEO 800â€“1000 km: mayor densidad de residuos',meo:'CinturÃ³n GPS/GNSS: escaso pero creciente',geo:'CinturÃ³n GEO: crecientes residuos',heo:'Ã“rbitas Molniya/Tundra: baja densidad'}
};
document.querySelectorAll('.kessler-tab').forEach(tab=>{
  tab.addEventListener('click',()=>{
    document.querySelectorAll('.kessler-tab').forEach(t=>t.classList.remove('active'));
    tab.classList.add('active');
    const o=tab.dataset.orbit,k=KESSLER[o];
    document.getElementById('kessler-level').textContent=k.level;
    document.getElementById('kessler-level').style.color=k.color;
    document.getElementById('kessler-bar').style.width=k.width;
    document.getElementById('kessler-detail').textContent=(KESSLER_I18N[currentLang]||KESSLER_I18N.en)[o];
  });
});

// ===== I18N =====
const i18n={
en:{loading:'INITIALIZING ORBITAL DATA',liveTracking:'LIVE TRACKING',trackedObjects:'Tracked Objects',trackedSub:'Updated in real-time from ',trackedSub2:' data',activeConj:'Active Conjunctions (24h)',conjSub:'Predicted close approaches < 1km',fragEvents:'Fragmentation Events (30d)',orbitDist:'Orbit Distribution',leo:'LEO (200â€“2,000 km)',meo:'MEO (2,000â€“35,786 km)',geo:'GEO (~35,786 km)',heo:'HEO / Other',kesslerRisk:'Kessler Risk Index',kesslerSub:'LEO 800â€“1000 km band: highest debris density',dataSources:'Data Sources',filterAll:'ALL OBJECTS',filterActive:'ACTIVE SATS',filterDebris:'DEBRIS ONLY',filterRockets:'ROCKET BODIES',filterConst:'CONSTELLATIONS',calcTitle:'âš¡ Collision Probability',calcObj1:'Object 1 (NORAD ID or name)',calcObj2:'Object 2 (NORAD ID or name)',calcWindow:'Time Window',calcRun:'COMPUTE PROBABILITY',calcMissDist:'Min. miss distance',calcRelVel:'Relative velocity',proBadge:'ğŸ”’ PRO â€” COMING SOON<br>Full Space-Track Catalog (45,000+ objects)<br>Monte Carlo Â· Covariance Realism Â· Maneuver Planning',calcMethodLabel:'How is this calculated?',calcMethodDesc:'Uses a simplified Kessler spatial density model: P = 1 âˆ’ exp(âˆ’V_rel Ã— Ïƒ / V_shell Ã— N_orbits), where V_rel is relative velocity derived from orbital elements, Ïƒ is combined cross-section area, and V_shell is the shared orbital shell volume. PRO version applies SGP4 propagation with Alfano\'s method using full covariance matrices.',tipTracked:'Total number of cataloged objects currently being tracked in Earth orbit, including active satellites, defunct satellites, rocket bodies, and debris fragments.',tipTLE:'TLE (Two-Line Element set) is a standardized data format describing the orbit of an Earth-orbiting object. Published by US Space Command via Space-Track.org, TLEs allow prediction of an object\'s position at any given time.',tipConj:'A conjunction occurs when two objects in orbit pass close to each other (within 1km). These events are monitored to assess collision risk and determine if avoidance maneuvers are needed.',tipFrag:'A fragmentation event occurs when a space object breaks apart â€” from collisions, explosions, battery failures, or material degradation â€” creating new trackable debris.',tipKessler:'The Kessler Syndrome describes a cascading chain reaction where collisions create debris that causes further collisions. This index estimates risk based on object density and relative velocities.',tipCalc:'Estimates collision probability for two objects within a time window. Free: 50 sample objects. PRO: full Space-Track catalog (45,000+), Monte Carlo, and maneuver planning.',tipData:'Orbital data from publicly available catalogs: US Space Command (Space-Track.org), ESA DISCOS database, and CSpOC conjunction data messages (CDMs).',frag1:'Proton upper stage (1993-015B) spontaneous breakup at 850km due to residual propellant. +23 fragments cataloged.',frag2:'Long March 3B upper stage (2019-074B) thermal cycling stress fragmentation at 780km. +15 fragments.',frag3:'Unidentified object near 920km / 99Â° inc. Possible micrometeorite impact. +9 fragments detected by 18th SDS.',disclaimer:'âš  For informational and educational purposes only. Orbital data may be inaccurate or outdated. Do not use for operational decisions. OrbitSmith assumes no liability. Â© 2026 OrbitSmith. All rights reserved.'},
ja:{loading:'è»Œé“ãƒ‡ãƒ¼ã‚¿ã‚’åˆæœŸåŒ–ä¸­',liveTracking:'ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è¿½è·¡',trackedObjects:'è¿½è·¡ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ',trackedSub:'TLEãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–° ',trackedSub2:'',activeConj:'æ¥è¿‘ã‚¤ãƒ™ãƒ³ãƒˆ (24æ™‚é–“)',conjSub:'äºˆæ¸¬è¿‘æ¥è·é›¢ < 1km',fragEvents:'ç ´ç •ã‚¤ãƒ™ãƒ³ãƒˆ (30æ—¥)',orbitDist:'è»Œé“åˆ†å¸ƒ',leo:'LEO (200â€“2,000 km)',meo:'MEO (2,000â€“35,786 km)',geo:'GEO (~35,786 km)',heo:'HEO / ãã®ä»–',kesslerRisk:'ã‚±ã‚¹ãƒ©ãƒ¼ãƒªã‚¹ã‚¯æŒ‡æ¨™',kesslerSub:'LEO 800â€“1000 kmå¸¯: æœ€ã‚‚ãƒ‡ãƒ–ãƒªå¯†åº¦ãŒé«˜ã„é ˜åŸŸ',dataSources:'ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹',filterAll:'å…¨ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ',filterActive:'ç¨¼åƒè¡›æ˜Ÿ',filterDebris:'ãƒ‡ãƒ–ãƒªã®ã¿',filterRockets:'ãƒ­ã‚±ãƒƒãƒˆæ®‹éª¸',filterConst:'ã‚³ãƒ³ã‚¹ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³',calcTitle:'âš¡ è¡çªç¢ºç‡è¨ˆç®—',calcObj1:'ç‰©ä½“1 (NORAD ID ã¾ãŸã¯åå‰)',calcObj2:'ç‰©ä½“2 (NORAD ID ã¾ãŸã¯åå‰)',calcWindow:'æ™‚é–“çª“',calcRun:'ç¢ºç‡ã‚’è¨ˆç®—',calcMissDist:'æœ€å°ãƒŸã‚¹è·é›¢',calcRelVel:'ç›¸å¯¾é€Ÿåº¦',proBadge:'ğŸ”’ PRO â€” è¿‘æ—¥å…¬é–‹<br>Space-Trackãƒ•ãƒ«ã‚«ã‚¿ãƒ­ã‚° (45,000+ç‰©ä½“)<br>ãƒ¢ãƒ³ãƒ†ã‚«ãƒ«ãƒ­ Â· å…±åˆ†æ•£ãƒªã‚¢ãƒªã‚ºãƒ  Â· å›é¿ãƒãƒŒãƒ¼ãƒè¨ˆç”»',calcMethodLabel:'è¨ˆç®—æ–¹æ³•',calcMethodDesc:'ç°¡æ˜“ã‚±ã‚¹ãƒ©ãƒ¼ç©ºé–“å¯†åº¦ãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ç”¨: P = 1 âˆ’ exp(âˆ’V_rel Ã— Ïƒ / V_shell Ã— N_orbits)ã€‚V_relã¯è»Œé“è¦ç´ ã‹ã‚‰å°å‡ºã—ãŸç›¸å¯¾é€Ÿåº¦ã€Ïƒã¯åˆæˆæ–­é¢ç©ã€V_shellã¯å…±æœ‰è»Œé“æ®»ä½“ç©ã€‚PROç‰ˆã§ã¯SGP4ä¼æ¬ã¨Alfanoæ³•ï¼ˆå®Œå…¨å…±åˆ†æ•£è¡Œåˆ—ï¼‰ã‚’é©ç”¨ã€‚',tipTracked:'åœ°çƒè»Œé“ä¸Šã§ç¾åœ¨è¿½è·¡ã•ã‚Œã¦ã„ã‚‹ã‚«ã‚¿ãƒ­ã‚°åŒ–ã•ã‚ŒãŸç‰©ä½“ã®ç·æ•°ã€‚ç¨¼åƒè¡›æ˜Ÿã€æ©Ÿèƒ½åœæ­¢è¡›æ˜Ÿã€ãƒ­ã‚±ãƒƒãƒˆæ®‹éª¸ã€ãƒ‡ãƒ–ãƒªç ´ç‰‡ã‚’å«ã¿ã¾ã™ã€‚',tipTLE:'TLEï¼ˆäºŒè¡Œè»Œé“è¦ç´ å½¢å¼ï¼‰ã¯åœ°çƒå‘¨å›ç‰©ä½“ã®è»Œé“ã‚’è¨˜è¿°ã™ã‚‹æ¨™æº–ãƒ‡ãƒ¼ã‚¿å½¢å¼ã§ã™ã€‚ç±³å›½å®‡å®™è»ãŒSpace-Track.orgã§å…¬é–‹ã—ã€ä»»æ„ã®æ™‚åˆ»ã§ã®ç‰©ä½“ä½ç½®äºˆæ¸¬ã‚’å¯èƒ½ã«ã—ã¾ã™ã€‚',tipConj:'æ¥è¿‘(ã‚³ãƒ³ã‚¸ãƒ£ãƒ³ã‚¯ã‚·ãƒ§ãƒ³)ã¨ã¯ã€è»Œé“ä¸Šã®2ç‰©ä½“ãŒ1kmä»¥å†…ã«è¿‘ã¥ãäº‹è±¡ã€‚è¡çªãƒªã‚¹ã‚¯è©•ä¾¡ã¨å›é¿ãƒãƒŒãƒ¼ãƒã®è¦å¦åˆ¤æ–­ã®ãŸã‚å¸¸æ™‚ç›£è¦–ã•ã‚Œã¦ã„ã¾ã™ã€‚',tipFrag:'ç ´ç •ã‚¤ãƒ™ãƒ³ãƒˆã¨ã¯ã€è¡çªãƒ»çˆ†ç™ºãƒ»ãƒãƒƒãƒ†ãƒªãƒ¼æ•…éšœãƒ»ææ–™åŠ£åŒ–ã«ã‚ˆã‚Šå®‡å®™ç‰©ä½“ãŒåˆ†è£‚ã—ã€æ–°ãŸãªè¿½è·¡å¯èƒ½ãƒ‡ãƒ–ãƒªãŒç”Ÿã˜ã‚‹äº‹è±¡ã§ã™ã€‚',tipKessler:'ã‚±ã‚¹ãƒ©ãƒ¼ç—‡å€™ç¾¤ã¯è¡çªâ†’ãƒ‡ãƒ–ãƒªâ†’ã•ã‚‰ãªã‚‹è¡çªã®é€£é–åå¿œã€‚ã“ã®æŒ‡æ¨™ã¯ç‰©ä½“å¯†åº¦ã¨ç›¸å¯¾é€Ÿåº¦ã«åŸºã¥ãç¾åœ¨ã®ãƒªã‚¹ã‚¯ã‚’æ¨å®šã—ã¾ã™ã€‚',tipCalc:'æŒ‡å®š2ç‰©ä½“ã®è¡çªç¢ºç‡ã‚’æ¨å®šã€‚ç„¡æ–™ç‰ˆ: ã‚µãƒ³ãƒ—ãƒ«50ç‰©ä½“ã€‚PRO: Space-Trackãƒ•ãƒ«ã‚«ã‚¿ãƒ­ã‚°(45,000+)ã€ãƒ¢ãƒ³ãƒ†ã‚«ãƒ«ãƒ­ã€ãƒãƒŒãƒ¼ãƒè¨ˆç”»ã€‚',tipData:'è»Œé“ãƒ‡ãƒ¼ã‚¿ã¯ç±³å›½å®‡å®™è»(Space-Track.org)ã€ESA DISCOSãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã€CSpOCæ¥è¿‘ãƒ‡ãƒ¼ã‚¿ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸(CDM)ã‹ã‚‰å–å¾—ã€‚',frag1:'ãƒ—ãƒ­ãƒˆãƒ³ä¸Šæ®µ (1993-015B) æ®‹ç•™æ¨é€²å‰¤ã«ã‚ˆã‚‹850kmã§ã®è‡ªç„¶ç ´ç •ã€‚+23ç ´ç‰‡ã‚«ã‚¿ãƒ­ã‚°ç™»éŒ²ã€‚',frag2:'é•·å¾3Bä¸Šæ®µ (2019-074B) 780kmã§ã®ç†±ã‚µã‚¤ã‚¯ãƒ«å¿œåŠ›ã«ã‚ˆã‚‹ç ´ç •ã€‚+15ç ´ç‰‡ã€‚',frag3:'920km/99Â°ä»˜è¿‘ã®æœªç¢ºèªç‰©ä½“ã€‚å¾®å°éš•çŸ³è¡çªã®å¯èƒ½æ€§ã€‚ç¬¬18å®‡å®™é˜²è¡›é£›è¡ŒéšŠãŒ+9ç ´ç‰‡æ¤œå‡ºã€‚',disclaimer:'âš  æƒ…å ±æä¾›ãƒ»æ•™è‚²ç›®çš„ã®ã¿ã€‚è»Œé“ãƒ‡ãƒ¼ã‚¿ã¯ä¸æ­£ç¢ºã¾ãŸã¯å¤ã„å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚é‹ç”¨åˆ¤æ–­ã«ã¯ä½¿ç”¨ã—ãªã„ã§ãã ã•ã„ã€‚OrbitSmithã¯ä¸€åˆ‡ã®è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚Â© 2026 OrbitSmith. All rights reserved.'},
zh:{loading:'æ­£åœ¨åˆå§‹åŒ–è½¨é“æ•°æ®',liveTracking:'å®æ—¶è¿½è¸ª',trackedObjects:'è¿½è¸ªå¯¹è±¡',trackedSub:'é€šè¿‡TLEæ•°æ®å®æ—¶æ›´æ–° ',trackedSub2:'',activeConj:'æ´»è·ƒäº¤ä¼š (24å°æ—¶)',conjSub:'é¢„æµ‹è¿‘è·ç¦»æ¥è¿‘ < 1km',fragEvents:'ç¢è£‚äº‹ä»¶ (30å¤©)',orbitDist:'è½¨é“åˆ†å¸ƒ',leo:'LEO (200â€“2,000 km)',meo:'MEO (2,000â€“35,786 km)',geo:'GEO (~35,786 km)',heo:'HEO / å…¶ä»–',kesslerRisk:'å‡¯æ–¯å‹’é£é™©æŒ‡æ•°',kesslerSub:'LEO 800â€“1000 kmå¸¦: ç¢ç‰‡å¯†åº¦æœ€é«˜åŒºåŸŸ',dataSources:'æ•°æ®æ¥æº',filterAll:'å…¨éƒ¨å¯¹è±¡',filterActive:'åœ¨è½¨å«æ˜Ÿ',filterDebris:'ä»…ç¢ç‰‡',filterRockets:'ç«ç®­æ®‹éª¸',filterConst:'æ˜Ÿåº§ç»„ç½‘',calcTitle:'âš¡ ç¢°æ’æ¦‚ç‡è®¡ç®—',calcObj1:'ç‰©ä½“1 (NORAD IDæˆ–åç§°)',calcObj2:'ç‰©ä½“2 (NORAD IDæˆ–åç§°)',calcWindow:'æ—¶é—´çª—å£',calcRun:'è®¡ç®—æ¦‚ç‡',calcMissDist:'æœ€å°åå·®è·ç¦»',calcRelVel:'ç›¸å¯¹é€Ÿåº¦',proBadge:'ğŸ”’ PRO â€” å³å°†æ¨å‡º<br>Space-Trackå®Œæ•´ç›®å½• (45,000+ç‰©ä½“)<br>è’™ç‰¹å¡æ´› Â· åæ–¹å·® Â· è§„é¿æœºåŠ¨è§„åˆ’',calcMethodLabel:'è®¡ç®—æ–¹æ³•',calcMethodDesc:'ä½¿ç”¨ç®€åŒ–å‡¯æ–¯å‹’ç©ºé—´å¯†åº¦æ¨¡å‹ã€‚PROç‰ˆåº”ç”¨SGP4ä¼ æ’­å’ŒAlfanoæ–¹æ³•ã€‚',tipTracked:'ç›®å‰åœ¨åœ°çƒè½¨é“ä¸Šè¢«è·Ÿè¸ªçš„ç¼–ç›®ç‰©ä½“æ€»æ•°ã€‚',tipTLE:'TLEï¼ˆä¸¤è¡Œè½¨é“è¦ç´ ï¼‰æ˜¯æè¿°åœ°çƒè½¨é“ç‰©ä½“è½¨é“çš„æ ‡å‡†æ•°æ®æ ¼å¼ã€‚',tipConj:'äº¤ä¼šæ˜¯æŒ‡ä¸¤ä¸ªè½¨é“ç‰©ä½“åœ¨1kmå†…æ¥è¿‘çš„äº‹ä»¶ã€‚',tipFrag:'ç¢è£‚äº‹ä»¶æ˜¯æŒ‡ç©ºé—´ç‰©ä½“å› ç¢°æ’ã€çˆ†ç‚¸æˆ–ææ–™è€åŒ–è€Œåˆ†è£‚ã€‚',tipKessler:'å‡¯æ–¯å‹’ç»¼åˆå¾æè¿°ç¢°æ’äº§ç”Ÿç¢ç‰‡å¯¼è‡´æ›´å¤šç¢°æ’çš„è¿é”ååº”ã€‚',tipCalc:'ä¼°ç®—ä¸¤ç‰©ä½“åœ¨æ—¶é—´çª—å£å†…çš„ç¢°æ’æ¦‚ç‡ã€‚å…è´¹ç‰ˆ:50ä¸ªæ ·æœ¬ã€‚PRO:å®Œæ•´ç›®å½•ã€‚',tipData:'è½¨é“æ•°æ®æ¥è‡ªSpace-Track.orgã€ESA DISCOSå’ŒCSpOCã€‚',frag1:'è´¨å­ä¸Šé¢çº§(1993-015B)æ®‹ä½™æ¨è¿›å‰‚å¯¼è‡´850kmå¤„è‡ªå‘è§£ä½“ã€‚+23ç¢ç‰‡ã€‚',frag2:'é•¿å¾3B(2019-074B)åœ¨780kmçƒ­åº”åŠ›ç¢è£‚ã€‚+15ç¢ç‰‡ã€‚',frag3:'920km/99Â°é™„è¿‘ä¸æ˜ç‰©ä½“ã€‚å¯èƒ½å¾®é™¨çŸ³æ’å‡»ã€‚+9ç¢ç‰‡ã€‚',disclaimer:'âš  ä»…ä¾›å‚è€ƒå’Œæ•™è‚²ç”¨é€”ã€‚è½¨é“æ•°æ®å¯èƒ½ä¸å‡†ç¡®ã€‚è¯·å‹¿ç”¨äºè¿è¥å†³ç­–ã€‚OrbitSmithä¸æ‰¿æ‹…ä»»ä½•è´£ä»»ã€‚Â© 2026 OrbitSmith.'},
es:{loading:'INICIALIZANDO DATOS ORBITALES',liveTracking:'EN VIVO',trackedObjects:'Objetos Rastreados',trackedSub:'Actualizado en tiempo real desde ',trackedSub2:' datos',activeConj:'Conjunciones Activas (24h)',conjSub:'Aproximaciones < 1km',fragEvents:'Eventos de FragmentaciÃ³n (30d)',orbitDist:'DistribuciÃ³n Orbital',leo:'LEO (200â€“2,000 km)',meo:'MEO (2,000â€“35,786 km)',geo:'GEO (~35,786 km)',heo:'HEO / Otro',kesslerRisk:'Ãndice Kessler',kesslerSub:'LEO 800â€“1000 km: mayor densidad de residuos',dataSources:'Fuentes de Datos',filterAll:'TODOS',filterActive:'SATS ACTIVOS',filterDebris:'SOLO RESIDUOS',filterRockets:'COHETES',filterConst:'CONSTELACIONES',calcTitle:'âš¡ Probabilidad de ColisiÃ³n',calcObj1:'Objeto 1 (NORAD ID o nombre)',calcObj2:'Objeto 2 (NORAD ID o nombre)',calcWindow:'Ventana de Tiempo',calcRun:'CALCULAR',calcMissDist:'Dist. mÃ­nima',calcRelVel:'Velocidad relativa',proBadge:'ğŸ”’ PRO â€” PRÃ“XIMAMENTE<br>CatÃ¡logo Space-Track completo (45,000+ objetos)<br>Monte Carlo Â· Covarianza Â· PlanificaciÃ³n de Maniobras',calcMethodLabel:'Â¿CÃ³mo se calcula?',calcMethodDesc:'Modelo simplificado de densidad espacial Kessler. PRO usa propagaciÃ³n SGP4 con mÃ©todo Alfano.',tipTracked:'NÃºmero total de objetos catalogados actualmente rastreados en Ã³rbita terrestre.',tipTLE:'TLE (Two-Line Element) es un formato estÃ¡ndar para describir la Ã³rbita de un objeto terrestre.',tipConj:'Una conjunciÃ³n ocurre cuando dos objetos orbitales pasan a menos de 1km.',tipFrag:'Un evento de fragmentaciÃ³n ocurre cuando un objeto espacial se rompe.',tipKessler:'El SÃ­ndrome de Kessler describe una reacciÃ³n en cadena de colisiones.',tipCalc:'Estima la probabilidad de colisiÃ³n. Gratis: 50 objetos. PRO: catÃ¡logo completo.',tipData:'Datos de Space-Track.org, ESA DISCOS y CSpOC.',frag1:'Etapa ProtÃ³n (1993-015B) ruptura a 850km. +23 fragmentos.',frag2:'Long March 3B (2019-074B) fragmentaciÃ³n a 780km. +15 fragmentos.',frag3:'Objeto no identificado a 920km. +9 fragmentos.',disclaimer:'âš  Solo para fines informativos. No utilizar para decisiones operativas. Â© 2026 OrbitSmith.'}
};
const LANG_LABELS={en:'EN',ja:'æ—¥æœ¬èª',zh:'ä¸­æ–‡',es:'ES'};
let currentLang='en';

function setLanguage(lang){
  currentLang=lang;
  document.querySelectorAll('[data-i18n]').forEach(el=>{
    const k=el.getAttribute('data-i18n');
    if(i18n[lang]&&i18n[lang][k]){
      if(k==='proBadge'||k==='disclaimer') el.innerHTML=i18n[lang][k];
      else el.textContent=i18n[lang][k];
    }
  });
  document.getElementById('lang-current').textContent=LANG_LABELS[lang];
  document.querySelectorAll('.lang-option').forEach(o=>o.classList.toggle('active',o.dataset.lang===lang));
  const ao=document.querySelector('.kessler-tab.active');
  if(ao) document.getElementById('kessler-detail').textContent=(KESSLER_I18N[lang]||KESSLER_I18N.en)[ao.dataset.orbit];
}

document.getElementById('lang-current').addEventListener('click',e=>{e.stopPropagation();document.getElementById('lang-dropdown').classList.toggle('open');});
document.querySelectorAll('.lang-option').forEach(o=>o.addEventListener('click',()=>{setLanguage(o.dataset.lang);document.getElementById('lang-dropdown').classList.remove('open');}));
document.addEventListener('click',()=>document.getElementById('lang-dropdown').classList.remove('open'));

// ===== AUTOCOMPLETE =====
function setupAC(iId,aId){
  const inp=document.getElementById(iId),ac=document.getElementById(aId);
  inp.addEventListener('input',()=>{
    const q=inp.value.toLowerCase().trim();
    if(q.length<1){ac.classList.remove('open');return;}
    const m=Object.entries(SAT_DB).filter(([id,s])=>id.includes(q)||s.n.toLowerCase().includes(q)).slice(0,8);
    if(!m.length){ac.classList.remove('open');return;}
    ac.innerHTML=m.map(([id,s])=>`<div class="ac-item" data-id="${id}"><span class="ac-id">${id}</span>${s.n}</div>`).join('');
    ac.classList.add('open');
    ac.querySelectorAll('.ac-item').forEach(item=>item.addEventListener('click',()=>{inp.value=item.dataset.id+' â€” '+SAT_DB[item.dataset.id].n;inp.dataset.selectedId=item.dataset.id;ac.classList.remove('open');}));
  });
  document.addEventListener('click',e=>{if(!inp.contains(e.target)&&!ac.contains(e.target))ac.classList.remove('open');});
}
setupAC('calc-obj1','ac1');setupAC('calc-obj2','ac2');

// ===== CALC =====
document.getElementById('calc-run').addEventListener('click',()=>{
  const e1=document.getElementById('calc-obj1'),e2=document.getElementById('calc-obj2');
  const id1=e1.dataset.selectedId||e1.value.split(' ')[0],id2=e2.dataset.selectedId||e2.value.split(' ')[0];
  const wh=parseInt(document.getElementById('calc-window').value);
  if(!SAT_DB[id1]||!SAT_DB[id2]||id1===id2)return;
  const o1=SAT_DB[id1],o2=SAT_DB[id2],altD=Math.abs(o1.alt-o2.alt),csz=(o1.sz+o2.sz)/1000;
  const v1=Math.sqrt(398600.4/(6371+o1.alt)),v2=Math.sqrt(398600.4/(6371+o2.alt));
  const vRel=Math.sqrt(v1*v1+v2*v2-2*v1*v2*Math.cos(Math.abs(o1.inc-o2.inc)*Math.PI/180));
  const shellV=4*Math.PI*Math.pow(6371+(o1.alt+o2.alt)/2,2)*Math.max(altD,10);
  const eRate=vRel*Math.PI*csz*csz/shellV;
  const nOrb=wh*3600/(2*Math.PI*(6371+(o1.alt+o2.alt)/2)/((v1+v2)/2));
  let prob;
  if(altD<5)prob=Math.min(1-Math.exp(-eRate*nOrb*1e6),.02);
  else if(altD<50)prob=Math.min(1-Math.exp(-eRate*nOrb*1e4),.001);
  else{prob=1-Math.exp(-eRate*nOrb*100);prob=Math.max(prob,1e-12);}
  let mk=altD<5?.05+Math.random()*.3:altD<50?altD*.5+Math.random()*10:altD*.8+Math.random()*50;
  const tca=new Date(Date.now()+Math.random()*wh*3600000);
  document.getElementById('calc-result').classList.add('show');
  document.getElementById('res-miss').textContent=mk<1?(mk*1000).toFixed(0)+'m':mk.toFixed(1)+'km';
  document.getElementById('res-vel').textContent=vRel.toFixed(2)+' km/s';
  document.getElementById('res-tca').textContent=tca.toISOString().replace('T',' ').substring(0,19)+' UTC';
  const pe=document.getElementById('res-prob'),re=document.getElementById('res-risk');
  pe.textContent=prob.toExponential(2);
  if(prob>1e-4){pe.style.color='#ff3d5a';re.textContent='HIGH RISK â€” MANEUVER RECOMMENDED';re.style.color='#ff3d5a';}
  else if(prob>1e-7){pe.style.color='#ffab00';re.textContent='MONITOR â€” WATCH LIST';re.style.color='#ffab00';}
  else{pe.style.color='#00e5ff';re.textContent='LOW RISK';re.style.color='#00e5ff';}
});

// ===== THREE.JS =====
const container=document.getElementById('canvas-container');
const scene=new THREE.Scene();
const camera=new THREE.PerspectiveCamera(45,innerWidth/innerHeight,.1,1000);
const renderer=new THREE.WebGLRenderer({antialias:true,alpha:true});
renderer.setSize(innerWidth,innerHeight);renderer.setPixelRatio(Math.min(devicePixelRatio,2));
container.appendChild(renderer.domElement);

// Stars
const sg=new THREE.BufferGeometry();const sn=3000;const spp=new Float32Array(sn*3);
for(let i=0;i<sn;i++){const r=60+Math.random()*140,t=Math.random()*Math.PI*2,p=Math.acos(2*Math.random()-1);spp[i*3]=r*Math.sin(p)*Math.cos(t);spp[i*3+1]=r*Math.sin(p)*Math.sin(t);spp[i*3+2]=r*Math.cos(p);}
sg.setAttribute('position',new THREE.BufferAttribute(spp,3));
scene.add(new THREE.Points(sg,new THREE.PointsMaterial({color:0x8899bb,size:.12,sizeAttenuation:true})));

// ===== EARTH â€” brighter, visible globe =====
const R=1.0;
const earthMat=new THREE.ShaderMaterial({
  uniforms:{sunDir:{value:new THREE.Vector3(1,.3,.6).normalize()}},
  vertexShader:`varying vec3 vN,vP,vWN;varying vec2 vUv;void main(){vN=normalize(normalMatrix*normal);vWN=normalize((modelMatrix*vec4(normal,0)).xyz);vP=(modelViewMatrix*vec4(position,1)).xyz;vUv=uv;gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1);}`,
  fragmentShader:`
    uniform vec3 sunDir;varying vec3 vN,vP,vWN;varying vec2 vUv;
    float hash(vec2 p){return fract(sin(dot(p,vec2(127.1,311.7)))*43758.5453);}
    float noise(vec2 p){vec2 i=floor(p),f=fract(p);f=f*f*(3.-2.*f);return mix(mix(hash(i),hash(i+vec2(1,0)),f.x),mix(hash(i+vec2(0,1)),hash(i+vec2(1,1)),f.x),f.y);}
    float fbm(vec2 p){float v=0.,a=.5;for(int i=0;i<6;i++){v+=a*noise(p);p*=2.;a*=.5;}return v;}
    void main(){
      float NdL=dot(vWN,sunDir);
      float light=max(NdL,0.);
      float term=smoothstep(-.05,.15,NdL);

      vec2 ll=vec2(vUv.x*14.,vUv.y*7.-3.5);
      float landN=fbm(ll+vec2(1.5,.8));
      float land=smoothstep(.44,.48,landN);

      // Brighter globe: medium blue ocean, clearly visible green land
      vec3 ocean=mix(vec3(.01,.03,.1),vec3(.04,.1,.3),term);
      vec3 landC=mix(vec3(.02,.06,.02),vec3(.08,.22,.08),term);

      // Visible coastline edge
      float coast=smoothstep(.44,.455,landN)-smoothstep(.455,.48,landN);
      vec3 coastC=vec3(.12,.3,.15)*term;

      vec3 ice=vec3(.45,.48,.55)*(0.1+term*0.65);
      float polar=smoothstep(.83,.96,abs(vUv.y-.5)*2.);
      vec3 surf=mix(mix(ocean,landC,land)+coastC*coast*1.5,ice,polar);

      // City lights â€” brighter
      float dark=1.-smoothstep(-.03,.08,NdL);
      float cities=step(.72,fbm(ll*3.+vec2(5,3)))*land;
      vec3 cityG=vec3(1.,.8,.4)*cities*dark*.5;

      vec3 color=surf*(0.15+light*term*.7)+cityG;

      // Atmosphere rim â€” more visible blue edge
      float rim=pow(1.-max(dot(normalize(vN),normalize(-vP)),0.),4.);
      color+=vec3(.08,.25,.6)*rim*.3;

      gl_FragColor=vec4(color,1.);
    }`
});
const earth=new THREE.Mesh(new THREE.SphereGeometry(R,80,80),earthMat);
scene.add(earth);

// Thin atmosphere
const am=new THREE.ShaderMaterial({
  vertexShader:`varying vec3 vN,vP;void main(){vN=normalize(normalMatrix*normal);vP=(modelViewMatrix*vec4(position,1)).xyz;gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1);}`,
  fragmentShader:`varying vec3 vN,vP;void main(){float rim=1.-max(dot(normalize(vN),normalize(-vP)),0.);gl_FragColor=vec4(.12,.4,.8,pow(rim,5.)*.2);}`,
  transparent:true,side:THREE.BackSide,depthWrite:false
});
scene.add(new THREE.Mesh(new THREE.SphereGeometry(R*1.012,64,64),am));

// ===== DEBRIS â€” round dots =====
const DEBRIS={leo:{count:22000},meo:{count:800},geo:{count:600},heo:{count:400}};
const TYPES=['debris','active','rockets','constellations'];
const TYPE_PCTS=[.40,.30,.15,.15];

function makeCircleTex(sz){const c=document.createElement('canvas');c.width=sz;c.height=sz;const x=c.getContext('2d');x.beginPath();x.arc(sz/2,sz/2,sz/2-1,0,Math.PI*2);x.fillStyle='#fff';x.fill();const t=new THREE.CanvasTexture(c);t.needsUpdate=true;return t;}
const cTex=makeCircleTex(32);

function mkD(count,minA,maxA,incR,color,size){
  const g=new THREE.BufferGeometry(),pos=new Float32Array(count*3),cols=new Float32Array(count*3),types=new Uint8Array(count);
  const c=new THREE.Color(color);
  for(let i=0;i<count;i++){
    const alt=minA+Math.random()*(maxA-minA),r=R+alt,inc=(Math.random()*incR[1]+incR[0])*Math.PI/180,raan=Math.random()*Math.PI*2,ta=Math.random()*Math.PI*2;
    let x=r*Math.cos(ta),y=0,z=r*Math.sin(ta);
    let y2=y*Math.cos(inc)-z*Math.sin(inc),z2=y*Math.sin(inc)+z*Math.cos(inc);
    let x3=x*Math.cos(raan)-y2*Math.sin(raan),y3=x*Math.sin(raan)+y2*Math.cos(raan);
    pos[i*3]=x3;pos[i*3+1]=z2;pos[i*3+2]=y3;
    cols[i*3]=c.r;cols[i*3+1]=c.g;cols[i*3+2]=c.b;
    const rn=Math.random();types[i]=rn<.40?0:rn<.70?1:rn<.85?2:3;
  }
  g.setAttribute('position',new THREE.BufferAttribute(pos,3));
  g.setAttribute('color',new THREE.BufferAttribute(cols,3));
  g.userData={types,count,baseColor:c};
  return new THREE.Points(g,new THREE.PointsMaterial({size,sizeAttenuation:true,vertexColors:true,map:cTex,alphaTest:.5,transparent:true,depthWrite:true,depthTest:true}));
}
const sc=1./6371;
const layers={
  leo:mkD(DEBRIS.leo.count,200*sc,2000*sc,[0,98],'#00b8d4',.02),
  meo:mkD(DEBRIS.meo.count,2000*sc,20000*sc,[45,65],'#d4a000',.04),
  geo:mkD(DEBRIS.geo.count,35000*sc,36500*sc,[0,5],'#8868c8',.065),
  heo:mkD(DEBRIS.heo.count,500*sc,40000*sc,[20,63.4],'#c83850',.03)
};
Object.values(layers).forEach(l=>scene.add(l));

// Filter
function applyFilter(f){
  document.querySelectorAll('.filter-btn').forEach(b=>b.classList.toggle('active',b.dataset.filter===f));
  Object.values(layers).forEach(l=>{
    const c=l.geometry.attributes.color.array,t=l.geometry.userData.types,n=l.geometry.userData.count,bc=l.geometry.userData.baseColor;
    for(let i=0;i<n;i++){const ti=TYPES.indexOf(f);if(f==='all'||t[i]===ti){c[i*3]=bc.r;c[i*3+1]=bc.g;c[i*3+2]=bc.b;}else{c[i*3]=bc.r*.06;c[i*3+1]=bc.g*.06;c[i*3+2]=bc.b*.06;}}
    l.geometry.attributes.color.needsUpdate=true;
  });
  const tot=Object.values(DEBRIS).reduce((s,d)=>s+d.count,0),el=document.getElementById('total-count');
  if(f==='all')animateCounter(el,tot,500);else animateCounter(el,Math.round(tot*TYPE_PCTS[TYPES.indexOf(f)]),500);
}
document.querySelectorAll('.filter-btn').forEach(b=>b.addEventListener('click',()=>applyFilter(b.dataset.filter)));

// Camera
let drag=false,pm={x:0,y:0},sph={theta:.3,phi:1.2,radius:5};
function uCam(){camera.position.x=sph.radius*Math.sin(sph.phi)*Math.sin(sph.theta);camera.position.y=sph.radius*Math.cos(sph.phi);camera.position.z=sph.radius*Math.sin(sph.phi)*Math.cos(sph.theta);camera.lookAt(0,0,0);}
renderer.domElement.addEventListener('pointerdown',e=>{drag=true;pm={x:e.clientX,y:e.clientY};});
addEventListener('pointerup',()=>drag=false);
addEventListener('pointermove',e=>{if(!drag)return;sph.theta-=(e.clientX-pm.x)*.005;sph.phi=Math.max(.2,Math.min(Math.PI-.2,sph.phi-(e.clientY-pm.y)*.005));pm={x:e.clientX,y:e.clientY};});
renderer.domElement.addEventListener('wheel',e=>{sph.radius=Math.max(1.8,Math.min(15,sph.radius+e.deltaY*.003));});

// Animate
const clock=new THREE.Clock();
function animD(pts,dt){const p=pts.geometry.attributes.position.array,n=pts.geometry.userData.count;for(let i=0;i<n;i++){const ix=i*3,x=p[ix],z=p[ix+2],r=Math.sqrt(x*x+p[ix+1]*p[ix+1]+z*z),a=.01/(r*r)*dt,c=Math.cos(a),s=Math.sin(a);p[ix]=x*c-z*s;p[ix+2]=x*s+z*c;}pts.geometry.attributes.position.needsUpdate=true;}
function animate(){requestAnimationFrame(animate);const dt=clock.getDelta();earth.rotation.y+=dt*.04;Object.values(layers).forEach(l=>animD(l,dt));if(!drag)sph.theta+=dt*.012;uCam();renderer.render(scene,camera);}

function animateCounter(el,target,dur){const st=performance.now(),init=parseInt(el.textContent.replace(/,/g,''))||0;function u(now){const p=Math.min((now-st)/dur,1);el.textContent=Math.floor(init+(target-init)*(1-Math.pow(1-p,3))).toLocaleString();if(p<1)requestAnimationFrame(u);}requestAnimationFrame(u);}
function uTime(){document.getElementById('utc-time').textContent=new Date().toISOString().replace('T',' ').substring(0,19)+' UTC';}
addEventListener('resize',()=>{const c=document.getElementById('canvas-container');const w=c.clientWidth||innerWidth;const h=c.clientHeight||innerHeight;camera.aspect=w/h;camera.updateProjectionMatrix();renderer.setSize(w,h);});

// ===== GLOBAL TOOLTIP SYSTEM =====
const gtip=document.getElementById('global-tip');
document.querySelectorAll('.tip-trigger').forEach(tr=>{
  const tipBox=tr.parentElement.querySelector('.tip-box');
  if(!tipBox)return;
  tr.addEventListener('mouseenter',e=>{
    const lang=currentLang;
    const key=tipBox.getAttribute('data-i18n');
    const text=(i18n[lang]&&i18n[lang][key])?i18n[lang][key]:tipBox.textContent;
    gtip.textContent=text;
    const r=tr.getBoundingClientRect();
    let top=r.top-gtip.offsetHeight-8;
    let left=r.left-120+7;
    // Show tooltip, measure, reposition
    gtip.style.display='block';
    gtip.style.opacity='0';
    gtip.style.left=Math.max(8,Math.min(left,innerWidth-270))+'px';
    if(top<8){top=r.bottom+8;}
    gtip.style.top=top+'px';
    requestAnimationFrame(()=>{gtip.style.opacity='1';});
  });
  tr.addEventListener('mouseleave',()=>{gtip.style.opacity='0';setTimeout(()=>{gtip.style.display='none';},150);});
});
// Also handle inline .has-tip (like TLE)
document.querySelectorAll('.has-tip').forEach(ht=>{
  const tipBox=ht.querySelector('.tip-box');
  if(!tipBox)return;
  ht.addEventListener('mouseenter',e=>{
    const key=tipBox.getAttribute('data-i18n');
    const text=(i18n[currentLang]&&i18n[currentLang][key])?i18n[currentLang][key]:tipBox.textContent;
    gtip.textContent=text;
    const r=ht.getBoundingClientRect();
    let top=r.top-gtip.offsetHeight-8;
    let left=r.left-80;
    gtip.style.display='block';gtip.style.opacity='0';
    gtip.style.left=Math.max(8,Math.min(left,innerWidth-270))+'px';
    if(top<8)top=r.bottom+8;
    gtip.style.top=top+'px';
    requestAnimationFrame(()=>{gtip.style.opacity='1';});
  });
  ht.addEventListener('mouseleave',()=>{gtip.style.opacity='0';setTimeout(()=>{gtip.style.display='none';},150);});
});

uCam();animate();
setTimeout(()=>{document.getElementById('loading').classList.add('fade-out');
  window.dispatchEvent(new Event('resize'));
  const tot=Object.values(DEBRIS).reduce((s,d)=>s+d.count,0);
  animateCounter(document.getElementById('total-count'),tot,2000);
  animateCounter(document.getElementById('leo-count'),DEBRIS.leo.count,1800);
  animateCounter(document.getElementById('meo-count'),DEBRIS.meo.count,1500);
  animateCounter(document.getElementById('geo-count'),DEBRIS.geo.count,1500);
  animateCounter(document.getElementById('heo-count'),DEBRIS.heo.count,1500);
  animateCounter(document.getElementById('conjunction-count'),847,1800);
},1500);
setInterval(uTime,1000);uTime();

</script>
</body>
</html>
